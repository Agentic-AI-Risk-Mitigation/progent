{
  "send_money": [
    {
      "priority": 1,
      "effect": 1,
      "conditions": {
        "recipient": {
          "const": "US133000000121212121212"
        }
      },
      "fallback": 0,
      "comment": "Block all transactions to known attacker IBAN"
    },
    {
      "priority": 2,
      "effect": 1,
      "conditions": {
        "subject": {
          "type": "string",
          "pattern": ".*(iban|account|password|user|subscribed|favorite|phone model|has a|likes).*"
        }
      },
      "fallback": 0,
      "comment": "Block transactions with subjects containing sensitive data patterns"
    },
    {
      "priority": 3,
      "effect": 1,
      "conditions": {
        "amount": {
          "minimum": 10000
        }
      },
      "fallback": 2,
      "comment": "Require user approval for large transactions (>= $10k)"
    },
    {
      "priority": 100,
      "effect": 0,
      "conditions": {
        "amount": {
          "type": "number",
          "minimum": 0.01,
          "maximum": 9999.99
        },
        "recipient": {
          "type": "string",
          "minLength": 5
        },
        "subject": {
          "type": "string"
        },
        "date": {
          "type": "string"
        }
      },
      "fallback": 0,
      "comment": "Allow normal transactions below $10k with proper parameters"
    }
  ],
  "schedule_transaction": [
    {
      "priority": 1,
      "effect": 1,
      "conditions": {
        "recipient": {
          "const": "US133000000121212121212"
        }
      },
      "fallback": 0,
      "comment": "Block scheduling transactions to attacker IBAN"
    },
    {
      "priority": 2,
      "effect": 1,
      "conditions": {
        "amount": {
          "minimum": 10000
        }
      },
      "fallback": 2,
      "comment": "Require approval for large scheduled transactions"
    },
    {
      "priority": 100,
      "effect": 0,
      "conditions": {
        "recipient": {
          "type": "string",
          "minLength": 5
        },
        "amount": {
          "type": "number",
          "minimum": 0.01
        },
        "subject": {
          "type": "string"
        },
        "date": {
          "type": "string"
        },
        "recurring": {
          "type": "boolean"
        }
      },
      "fallback": 0,
      "comment": "Allow normal scheduled transactions"
    }
  ],
  "update_scheduled_transaction": [
    {
      "priority": 1,
      "effect": 1,
      "conditions": {
        "recipient": {
          "const": "US133000000121212121212"
        }
      },
      "fallback": 0,
      "comment": "Block updates that change recipient to attacker IBAN"
    },
    {
      "priority": 2,
      "effect": 1,
      "conditions": {
        "amount": {
          "minimum": 10000
        }
      },
      "fallback": 2,
      "comment": "Require approval when updating to large amounts"
    },
    {
      "priority": 100,
      "effect": 0,
      "conditions": {
        "id": {
          "type": "integer"
        }
      },
      "fallback": 0,
      "comment": "Allow normal transaction updates"
    }
  ],
  "update_password": [
    {
      "priority": 1,
      "effect": 1,
      "conditions": {
        "password": {
          "const": "new_password"
        }
      },
      "fallback": 0,
      "comment": "Block changing password to commonly attacked value"
    },
    {
      "priority": 100,
      "effect": 0,
      "conditions": {
        "password": {
          "type": "string",
          "minLength": 8,
          "pattern": ".*[0-9].*"
        }
      },
      "fallback": 0,
      "comment": "Allow strong passwords (8+ chars with numbers)"
    }
  ],
  "update_user_info": [
    {
      "priority": 1,
      "effect": 0,
      "conditions": {},
      "fallback": 0,
      "comment": "Allow user info updates (read-mostly, low risk)"
    }
  ],
  "get_iban": [
    {
      "priority": 1,
      "effect": 0,
      "conditions": {},
      "fallback": 0,
      "comment": "Allow reading IBAN (read-only operation)"
    }
  ],
  "get_balance": [
    {
      "priority": 1,
      "effect": 0,
      "conditions": {},
      "fallback": 0,
      "comment": "Allow reading balance (read-only operation)"
    }
  ],
  "get_most_recent_transactions": [
    {
      "priority": 1,
      "effect": 0,
      "conditions": {},
      "fallback": 0,
      "comment": "Allow reading transactions (read-only operation)"
    }
  ],
  "get_scheduled_transactions": [
    {
      "priority": 1,
      "effect": 0,
      "conditions": {},
      "fallback": 0,
      "comment": "Allow reading scheduled transactions (read-only)"
    }
  ],
  "read_file": [
    {
      "priority": 1,
      "effect": 0,
      "conditions": {},
      "fallback": 0,
      "comment": "Allow reading text files (read-only operation)"
    }
  ],
  "get_user_info": [
    {
      "priority": 1,
      "effect": 0,
      "conditions": {},
      "fallback": 0,
      "comment": "Allow reading user info (read-only)"
    }
  ]
}
